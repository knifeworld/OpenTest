#include <iostream>
#include <string>
using namespace std;
#include "olcConsoleGameEngine.h"

/*messager functions to streamline console output*/
template<typename T>
void LOG(T value)
{
	std::cout << value << std::endl;
}

void waitmsg(const std::string& str)
{
	std::cout << str << std::endl;
	cin.get();
}

void TestRegularConsole()
{
	for (int i = 0; i < 10000; i++)
		LOG(i);
}

/* Initialization test, uses custom console logger - */
/* - and waits for you to begin the program proper... */
void INIT_GX()
{
	LOG("Ready!");
	TestRegularConsole();
	waitmsg("press a key to begin program.");
}

/* 'One Lone Coder' olcConsoleGameEngine, by Javidx9 */
/* Source -> https://github.com/OneLoneCoder/videos */
class OpenTestGxGame : public olcConsoleGameEngine
{
public:
	OpenTestGxGame()
	{
		m_sAppName = L"GxTest";
	}

private:
	struct GxObject
	{
		float x;
		float y;
		float dx;
		float dy;
		int nSize;	
	};

	vector<GxObject> vecObj;

protected:
	virtual bool OnUserCreate()
	{
		vecObj.push_back({20.0f, 20.0f, 80.f, -6.0f, (int)16});

		return true;
	}

	virtual bool OnUserUpdate(float fElapsedTime)
	{
		Fill(0, 0, ScreenWidth(), ScreenHeight(), PIXEL_SOLID, BG_BLUE);

		for (auto &a : vecObj)
		{
			a.x += a.dx * fElapsedTime;
			a.y += a.dy * fElapsedTime;

			for (int x = 0; x < a.nSize; x++)
			{
				for (int y = 0; y < a.nSize; y++)
				{
					Draw(a.x + x, a.y + y, PIXEL_SOLID, FG_RED);
				}
			}
		}

		return true;
	}
};

/* Velocity = ( p2 - p1 / t ), Accel = ( v2 - v1 / t ) */
/* V2 = At + v1, P2 = Vt + p1 */

int main(int argc, char* argv[])
{
	/* Test custom LOG() and wait for us to begin */
	INIT_GX();

	OpenTestGxGame game;
	game.ConstructConsole(160, 100, 8, 8);
	game.Start();



	waitmsg("press a key to end program.");
	return 0;
}

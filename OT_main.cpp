#include <iostream>
#include <string>
#include <Windows.h>
#include <Mmreg.h> // for the OLC audio engine
#include "../OLCCloneRef/videos/olcConsoleGameEngine.h"

template<typename T>
void LOG(const T& value)
{
	std::cout << value << '\n';
}

void waitStr(const std::string& str)
{
	std::cout << str << '\n';
	std::cin.get();
}

void TestRegularConsole()
{
	for (int i = 0; i < 10000; ++i)
		LOG(i);
}

// Initialization test, uses custom logger
// waits to begin the program proper
void INIT_GX()
{
	LOG("Ready!");
	TestRegularConsole();
	waitStr("press a key to begin program.");
}

// 'One Lone Coder' olcConsoleGameEngine, by Javidx9
// Source -> https://github.com/OneLoneCoder/videos
class OpenTestGxGame : public olcConsoleGameEngine
{
public:
	OpenTestGxGame()
	{
		m_sAppName = TEXT("GxTest");
	}

private:
	struct GxObject
	{
		double x;
		double y;
		double dx;
		double dy;
		int nSizeX;	
		int nSizeY;	
	};

	std::vector<GxObject> vecObj;

protected:
	virtual bool OnUserCreate()
	{
		vecObj.push_back({20.0f, 20.0f, 80.f, -6.0f, 16, 16});

		return true;
	}

	virtual bool OnUserUpdate(float fElapsedTime)
	{
		Fill(0, 0, ScreenWidth(), ScreenHeight(), PIXEL_SOLID, BG_BLUE);

		for (GxObject& Gob : vecObj)
		{
			Gob.x += Gob.dx * static_cast<double>(fElapsedTime);
			Gob.y += Gob.dy * static_cast<double>(fElapsedTime);

			for (int x = 0; x < Gob.nSizeX; ++x)
			{
				for (int y = 0; y < Gob.nSizeY; ++y)
				{
					Draw(static_cast<int>(Gob.x) + x, static_cast<int>(Gob.y) + y, PIXEL_SOLID, FG_RED);
				}
			}
		}

		return true;
	}
};


int main(int argc, char* argv[])
{
	INIT_GX();

	OpenTestGxGame game;
	game.ConstructConsole(160, 100, 8, 8);
	game.Start();

	waitStr("press a key to end program.");
	return 0;
}
